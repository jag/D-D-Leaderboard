<head>
	<title>Dungeons and Dragons</title>
</head>

<body>
	<div class="navbar">
		<div class="navbar-inner">
			<div id="new-character-box" class="container">
				<a class="brand" href="#">D&amp;D Leaderboard</a>
				<div class="nav-collapse">
					{{> navbar}}
				</div>
			</div>
		</div>
	</div>
	<div class="container">
		{{> characters}}
		{{> out-game-character}}
		<div id="test"></div>
	</div>
	<audio id="char-name-audio" style="display: none;"></audio>
</body>

<template name="enemy_form">
	<form id="enemy-form">
		<input type="hidden" id="enemy-id" value="">
		<div class="control-group">
			<label for="enemy-name">Name</label>
			<input type="text" id="enemy-name" placeholder="New enemy">
		</div>
		<div class="control-group">
			<label for="enemy-initiative">Initiative</label>
			<input type="number" class="integer" id="enemy-initiative" placeholder="Init">
		</div>
		<div class="control-group">
			<label for="enemy-max-hp">Health</label>
			<input type="number" class="integer" id="enemy-max-hp" placeholder="HP">
		</div>
		<div class="form-actions">
			<input type="button" id="enemy-add-button" class="btn btn-primary" value="Add">
			<input type="reset" id="enemy-reset-button" class="btn btn-danger" value="Reset">
		</div>
	</form>
</template>

<template name="navbar">
	<ul class="nav">
		<li><a href="#" id="next-character-link">Next Character</a></li>
	</ul>
	<form class="pull-right navbar-form form-inline">
		<input type="hidden" id="character-id" value="">
		<div class="control-group">
			<label for="new-character">Name</label>
			<input type="text" id="new-character" placeholder="New character">
		</div>
		<div class="control-group">
			<label for="new-initiative">Initiative</label>
			<input type="number" class="integer" id="new-initiative" placeholder="Init">
		</div>
		<fieldset>
			<div class="control-group">
				<label for="char-ac">Armor class</label>
	    	<input type="number" id="char-ac" placeholder="AC" class="integer">
			</div>
			<div class="control-group">
				<label for="char-fort">Fortitude</label>
	    	<input type="number" id="char-fort" placeholder="Fort" class="integer">
			</div>
			<div class="control-group">
				<label for="char-ref">Reflex</label>
	    	<input type="number" id="char-ref" placeholder="Ref" class="integer">
			</div>
			<div class="control-group">
				<label for="char-will">Willpower</label>
	    	<input type="number" id="char-will" placeholder="Will" class="integer">
			</div>
		</fieldset>
		<div class="control-group">
			<label for="char-dmg">Default damage</label>
    	<input type="number" id="char-dmg" placeholder="~Dmg">
		</div>
		<div class="control-group">
			<input type="checkbox" id="new-enemy">
			<label for="new-enemy">Enemy?</label>
		</div>
		<div class="control-group">
			<input type="checkbox" id="in-game" checked="checked">
			<label for="in-game">Playing?</label>
		</div>
		<div class="form-actions">
			<input type="button" id="add-button" class="btn btn-primary btn-large" value="Add">
			<input type="reset" id="reset-button" class="btn btn-mini btn-danger" value="Reset">
		</div>
	</form>
</template>

<template name="characters">
	<section id="characters-view">
		<div class="row-fluid">
			<div class="span12" id="character-list-span">
				{{> character_list}}
			</div>
			{{> dm_view}}
		</div>
	</section>
	{{onCharactersLoaded}}
</template>

<template name="dm_view">
	<div id="dm-view" class="span6">
		{{> enemy_list}}
		{{> enemy_form}}
	</div>
</template>

<template name="char_table_header">
	<thead>
		<tr>
			<th scope="col" class="char-name">Character</th>
			<th scope="col" class="char-defenses">Defenses</th>
			<th scope="col" class="char-def-dmg">Default Damage</th>
			<th scope="col" class="char-initiative">Initiative</th>
			<th scope="col" class="char-options">Options</th>
		</tr>
	</thead>
</template>

<template name="enemy_list">
	<table id="enemy-table" class="table table-striped">
		<thead>
			<tr>
				<th scope="col">Enemy</th>
				<th scope="col">Health</th>
				<th scope="col">Options</th>
			</tr>
		</thead>
		<tbody>
			{{#each enemies}}
				{{> enemy}}
			{{/each}}
		</tbody>
	</table>
</template>

<template name="enemy">
	<tr>
		<td>{{name}}</td>
		<td>
			{{#if isBloodied}}
				<i class="icon-blood"></i>
			{{/if}}
			<span class="current-and-max-hp">
				<span class="current-hp">{{currentHP}}</span> / 
				<span class="max-hp">{{maxHP}}</span>
			</span>
		</td>
		<td>
			<a href="#delete" class="delete btn btn-danger"><i class="icon-white icon-trash"></i></a>
			<a href="#retire" title="Move enemy out of game" class="btn"><i class="icon-arrow-down"></i></a>
		</td>
	</tr>
</template>

<template name="character_list">
	<table id="character-table" class="table table-striped">
		{{> char_table_header}}
		<tbody>
			{{#each characters}}
				{{> character}}
			{{/each}}
		</tbody>
	</table>
</template>

<template name="character_def_dmg">
	{{#if isEnemy}}
		<td></td>
		<td></td>
	{{else}}
		<td class="char_defenses">
			<span class="defense-label">AC</span>
			<span class="armor-class defense">{{char_ac}}</span>
			<span class="defense-label">Fort</span>
			<span class="fortitude defense">{{char_fort}}</span>
			<span class="defense-label">Ref</span>
			<span class="reflex defense">{{char_ref}}</span>
			<span class="defense-label">Will</span>
			<span class="willpower defense">{{char_will}}</span>
		</td>
		<td class="char_damage">
			<i class="icon-sword"></i>
			{{damage}}
		</td>
	{{/if}}
</template>

<template name="character">
	{{#if active}}
		<tr id={{_id}} class="active enemy-{{isEnemy}}">
	{{else}}
		<tr id={{_id}} class="enemy-{{isEnemy}}">
	{{/if}}
		<td class="char-name">{{name}}</td>
		{{> character_def_dmg}}
		<td class="char-initiative">{{initiative}}</td>
		<td>
			<a href="#delete" class="delete btn btn-danger"><i class="icon-white icon-trash"></i></a>
			<a href="#retire" title="Move character out of game" class="btn"><i class="icon-arrow-down"></i></a>
		</td>
	</tr>  
</template>

<template name="out-game-character">
	<section class="out-of-game">
		<h2 class="page-header">Out of the Game</h2>
		<div class="row-fluid">
			<div class="span12">
				{{> out_game_character_list}}
			</div>
		</div>
	</section>
</template>

<template name="out_game_character_list">
	<table id="out-game-character-table" class="table table-striped">
		{{> char_table_header}}
		<tbody>
			{{#each characters}}
				{{> out_character}}
			{{/each}}
		</tbody>
	</table>
</template>

<template name="out_character">
	<tr id={{_id}} class="enemy-{{isEnemy}}">
		<td class="char-name">{{name}}</td>
		{{> character_def_dmg}}
 		<td>&mdash;</td>
		<td>
			<a href="#delete" class="delete btn btn-danger"><i class="icon-white icon-trash"></i></a>
			<a href="#bring-back" title="Return character to the game" class="btn"><i class="icon-arrow-up"></i></a>
		</td>
	</tr>
</template>

